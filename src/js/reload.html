<script src="/socket.io/socket.io.js"></script>
<script>
	var socket = io();

	var reloadGame = function() {
		window.location.reload();
		// window.location = window.location.href.split('?')[0] + '?' + Date.now();
	};

	var reloadScene = function(scene) {
		game.system.setScene(scene ||Â game.system.sceneName);
	};

	var reloadModule = function(module) {
		game.config.autoStart = false;
		game.ready = function() {
			reloadScene();
		};

		// Delete module classes
		for (var i = 0; i < game.modules[module].classes.length; i++) {
			var className = game.modules[module].classes[i];
			console.log('Deleting class ' + className);
			delete game[className];
		}

		// Delete module
		delete game.modules[module];

		// Load new module script
		var path = 'src/' + module.replace(/\./g, '/') + '.js';
		var script = document.createElement('script');
		script.type = 'text/javascript';
		script.src = path;
		script.onerror = function() {
		};
		document.getElementsByTagName('head')[0].appendChild(script);
	};

	socket.on('reloadScene', function(scene) {
		reloadScene(scene);
	});

	socket.on('reloadModule', function(module) {
		reloadModule(module);
	});

	socket.on('reloadGame', function() {
		reloadGame();
	});
</script>
